# نظام تحليل البيانات المالية

## الوصف
موقع ويب لتحليل ملفات الإكسل المالية وحساب العجز والخدمات والسلف والمشتريات بشكل تلقائي.

## المتطلبات
- متصفح ويب حديث يدعم JavaScript
- ملف إكسل يحتوي على الأعمدة التالية:
  - عمود المدين (أو ما يشابهه)
  - عمود الدائن (أو ما يشابهه)  
  - عمود الملاحظات (أو ما يشابهه)

## كيفية الاستخدام

### 1. فتح الموقع
افتح ملف `index.html` في متصفح الويب

### 2. رفع ملف الإكسل
- اضغط على زر "اختر ملف الإكسل"
- اختر ملف الإكسل الذي يحتوي على البيانات المالية
- تأكد أن الملف يحتوي على الأعمدة المطلوبة

### 3. تحليل البيانات
- اضغط على زر "تحليل البيانات"
- انتظر حتى يتم معالجة البيانات

### 4. مراجعة النتائج
ستظهر النتائج في أربعة أقسام:

#### مربع تحليل العجز
- **عجز مدين**: مجموع المبالغ في عمود المدين للصفوف التي تحتوي على كلمة "عجز"
- **عجز دائن**: مجموع المبالغ في عمود الدائن للصفوف التي تحتوي على كلمة "عجز"
- **صافي العجز**: الفرق بين عجز المدين وعجز الدائن (مدين - دائن)

#### مربع تحليل الخدمات
- **خدمات مدين**: مجموع المبالغ في عمود المدين للصفوف التي تحتوي على كلمة "خدمة"
- **خدمات دائن**: مجموع المبالغ في عمود الدائن للصفوف التي تحتوي على كلمة "خدمة"
- **صافي الخدمات**: الفرق بين خدمات المدين وخدمات الدائن (مدين - دائن)

#### مربع السلف والمشتريات
- **مدين**: مجموع المبالغ في عمود المدين للصفوف التي لا تحتوي على "عجز" أو "خدمة"
- **دائن**: مجموع المبالغ في عمود الدائن للصفوف التي لا تحتوي على "عجز" أو "خدمة"
- **صافي السلف والمشتريات**: الفرق بين المدين والدائن (مدين - دائن)

#### تحليل الأسماء (ميزة جديدة)
- **الاسم الأصلي**: الاسم الأكثر تكراراً في عمود الملاحظات مع إجماليه المالي
- **الأسماء المختلفة**: أي أسماء أخرى مختلفة عن الاسم الأصلي مع إجماليها المالي
- يعرض لكل اسم: المدين، الدائن، الصافي، وعدد العمليات
- الاسم الأصلي يظهر بلون أزرق والأسماء المختلفة بلون برتقالي

#### الملخص النهائي
- **إجمالي السلف والمشتريات**: صافي السلف والمشتريات
- **خصم الخدمات**: صافي الخدمات
- **العجز**: صافي العجز
- **الإجمالي النهائي**: مجموع جميع البنود أعلاه

## المميزات

### 1. واجهة عربية
- تصميم يدعم اللغة العربية بالكامل
- اتجاه النص من اليمين إلى اليسار (RTL)
- خطوط واضحة ومقروءة

### 2. معالجة ذكية للبيانات
- البحث التلقائي عن أعمدة المدين والدائن والملاحظات
- التعامل مع أسماء الأعمدة المختلفة (عربي وإنجليزي)
- تنظيف وتحويل البيانات الرقمية تلقائياً
- **تحليل ذكي للأسماء**: استخراج وتحليل الأسماء من عمود الملاحظات لتحديد الاسم الأكثر تكراراً والأسماء المختلفة

### 3. تصميم متجاوب
- يعمل على الهواتف المحمولة والأجهزة اللوحية
- تصميم جذاب وسهل الاستخدام
- ألوان متدرجة وتأثيرات بصرية

### 4. حسابات دقيقة
- معالجة دقيقة للأرقام والعملات
- عرض النتائج بتنسيق واضح
- حساب الإجماليات والصافي تلقائياً

## استكشاف الأخطاء

### إذا لم يتم التعرف على الأعمدة
تأكد أن أسماء الأعمدة تحتوي على:
- للمدين: "مدين" أو "المدين" أو "debit"
- للدائن: "دائن" أو "الدائن" أو "credit"  
- للملاحظات: "ملاحظات" أو "الملاحظات" أو "notes" أو "description"

### إذا كانت النتائج غير صحيحة
- تأكد أن البيانات الرقمية في أعمدة المدين والدائن صحيحة
- تأكد أن كلمات "عجز" و"خدمة" مكتوبة بشكل صحيح في عمود الملاحظات

## المطور
تم تطوير هذا النظام بواسطة MiniMax Agent